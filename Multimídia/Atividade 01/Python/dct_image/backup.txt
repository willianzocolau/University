import numpy as np
import matplotlib.pyplot as plt

Q_50 = [
    [16, 11, 10, 16, 24, 40, 51, 61],
    [12, 12, 14, 19, 26, 58, 60, 55],
    [14, 13, 16, 24, 40, 57, 69, 56],
    [14, 17, 22, 29, 51, 87, 80, 62],
    [18, 22, 37, 56, 68, 109, 103, 77],
    [24, 35, 55, 64, 81, 104, 113, 92],
    [49, 64, 78, 87, 103, 121, 120, 101],
    [72, 92, 95, 98, 112, 100, 103, 99]
]

ORIGINAL = np.array([
    [154, 123, 123, 123, 123, 123, 123, 136],
    [192, 180, 136, 154, 154, 154, 136, 110],
    [254, 198, 154, 154, 180, 154, 123, 123],
    [239, 180, 136, 180, 180, 166, 123, 123],
    [180, 154, 136, 167, 166, 149, 136, 136],
    [128, 136, 123, 136, 154, 180, 198, 154],
    [123, 105, 110, 149, 136, 136, 180, 166],
    [110, 136, 123, 123, 123, 136, 154, 136]
])

M = ORIGINAL - 128

T = np.array([
    [0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536],
    [0.4904, 0.4157, 0.2778, 0.0975, -0.0975, -0.2778, -0.4157, -0.4904],
    [0.4619, 0.1913, -0.1913, -0.4619, -0.4619, -0.1913, 0.1913, 0.4619],
    [0.4157, -0.0975, -0.4904, -0.2778, 0.2778, 0.4904, 0.0975, -0.4157],
    [0.3536, -0.3536, -0.3536, 0.3536, 0.3536, -0.3536, -0.3536, 0.3536],
    [0.2778, -0.4904, 0.0975, 0.4157, -0.4157, -0.0975, 0.4904, -0.2778],
    [0.1913, -0.4619, 0.4619, -0.1913, -0.1913, 0.4619, -0.4619, 0.1913],
    [0.0975, -0.2778, 0.4157, -0.4904, 0.4904, -0.4157, 0.2778, -0.0975]
])

D = np.dot(T, M)
D = np.dot(D, T.transpose())
D = D.round(1)

C = np.divide(D, Q_50)
C = C.round()

R = Q_50 * C

N = np.dot(T.transpose(), R)
N = np.dot(N, T)
N = N.round()
N = N + 128

print(N)
